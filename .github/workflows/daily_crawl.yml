name: Daily Star Forecast Crawl

on:
  schedule:
    # æ¯å¤©å°ç£æ™‚é–“ 00:00, 06:00, 12:00, 18:00 åŸ·è¡Œ
    - cron: '0 16,22,4,10 * * *'
  workflow_dispatch: # è®“ä½ å¯ä»¥æ‰‹å‹•é»æ“ŠåŸ·è¡Œ

# --- ğŸ’¡ æ–°å¢ï¼šæ˜ç¢ºé–‹å•Ÿå¯«å…¥æ¬Šé™ ---
permissions:
  contents: write

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v3

      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.12'

      - name: Install dependencies
        run: |
          pip install requests pandas beautifulsoup4 lxml

      - name: Run scraper
        # --- ğŸ’¡ ä¿®æ­£ï¼šç¢ºä¿æª”åèˆ‡ä½ çš„æª”æ¡ˆ scraper_final.py ä¸€è‡´ ---
        run: python scraper_final.py

      - name: Commit and Push changes
        run: |
          git config --local user.email "action@github.com"
          git config --local user.name "GitHub Action"
          git add all_taiwan_star_forecast.csv
          # å¦‚æœè³‡æ–™æ²’è®Šå‹•ï¼Œcommit æœƒå¤±æ•—ï¼Œä½¿ç”¨ || exit 0 è®“æµç¨‹æ­£å¸¸çµæŸ
          git commit -m "Auto update forecast data" || exit 0
          git push